# Pelissimo

This repository contains certain python scripts to automatize specific [PELE](https://pele.bsc.es/pele.wt) simulations: **protocol**.
Some others are meant to analyze PELE simulations in different ways: **analysis**.

## Contents


 * <b> 1. analysis:</b> Directory with the code related to analyze PELE simulations: 

   * **1.1. disc.py**: Script to: (1) Read all the information about a metric in a simulation and calculating different scoring functions.
 (2) Make plots of the evolution of the Boltzmann weighted average or minimum of a certain metric throughout a simulation.

   * **1.2. bootstrapping.py**: Script to generate bootstrap datasets and have statistics.

   * **1.3. pele_fetcher.py**: Script that fetches specific snapshot of a simulation.

   * **1.4. rmsd.py**: Script that prepares all to run an rmsd calculation in MN4.


 * <b> 2. protocol:</b> Directory with code related to the pelissimo protocol that is being assembled.

   * <b> 2.1 corrector:</b> Directory containing the code involved in the correction of the energies of a simulation.

     * **2.1.1 correction.py**: Script that retrieves entropy and strain corrections and implements them in the reports of the  induced fit simulation.

   * <b> 2.2 entropy:</b> Directory with the code related to the Ligand Conformational Entropy (LiCE) calculation

     * **2.2.1 lice.py**: Script that reads the results from dihedral clustering and further processes information to obtain an entropy change.
 
     * **2.2.2 dihedral_clustering.py**: Script that calculates dihedral angles for all the rotatable bonds in all the conformations reached 
 by the ligand in a simulation. This information will be used to cluster conformations. 

     * **2.2.3 entropy.py**: Script that ensembles the other two to make a complete entropy analysis of a simulation.

   * <b> 2.3 initial_files:</b> Directory with an example of the necessary files to perform a full simulation of the protocol.

   * <b> 2.4 strain:</b> Directory with the code related to the calculation of the Ligand Internal Energy (LInEn).
 
     * **2.4.1. linen.py**: Script to calculate LInEN with a PELE simulation of the ligand. 


## Examples

In all cases the usage of the flag _-h_ is recommended in order to understand the possibilities offered by the script.

```
python path/to/code/bootstrapping.py -h
```

In case of doubt the code can be read since all the functions are commented and explained.

### analysis 

All the analysis scripts are designed to be run from the father directory of the _output_ directory generated by PELE.

1. _disc.py_: In this case we want to analyze the reports inside output_1 and we want to take a look at the fifth metric in the reports.
```
python path/to/code/disc.py -d ouput_1 -c 5
```

2. _bootstrapping.py_: If we want to make 50 bootstrap datasets from the results in output_2 regarding the sasa:

```
python path/to/code/bootstrapping.py -d ouput_2 -ns 50 -m sasa
```

3. _pelefetcher.py_: If we want to extract the pose in epoch 4, trajectory 33, model 7 and save it as 1MTS_min.pdb:

```
python path/to/code/pele_fetcher.py -e 4 -t 33 -m 7 -s 1MTS_min
```

4. _rmsd.py_: We will require the ligand structure that we will base our RMSD upon (i.e. 1HPV_lig.pdb). :

```
python path/to/code/rmsd.py -pdbr 1HPV_lig.pdb
```


## protocol
### entropy

1. _dihedralclustering.py_: If we want to calculates the 1A28's ligand dihedrals of all the simulation stored in the folder called output_original
and cluster them with bins:

```
python path/to/code/dihedral_clustering.py -f 1A28_lig.pdb -d output_original 
```

### strain

1. _linen.py_: This code requires a DataLocal folder of the ligand.
If we want to make a ligand-alone simulation of the 1A28_lig.pdb file with OpenFF and OBC as forcefield and solvent model:

```
python path/to/code/linen.py -f 1A28_lig.pdb -ff OpenFF-OPLS2005 -sm OBC
```





