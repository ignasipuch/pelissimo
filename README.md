# Pelissimo

This repository contains certain python scripts to automatize specific [PELE](https://pele.bsc.es/pele.wt) simulations and some others to analyze PELE simulations.

## Contents


 * <b> 1. analysis:</b> Directory with the code related to analyze PELE simulations: 

   * **1.1. disc.py**: Script to: (1) Read all the information about a metric in a simulation and calculating different scoring functions.
 (2) Make plots of the evolution of the Boltzmann weighted average or minimum of a certain metric throughout a simulation.

   * **1.2. bootstrapping.py**: Script to generate bootstrap datasets and have statistics.

   * **1.3. pele_fetcher.py**: Script that fetches specific snapshot of a simulation.

 * <b> 2. corrector:</b> Directory containing the code involved in the correction of the energies of a simulation.

   * **2.1. correction.py**: Script that retrieves entropy and strain corrections and implements them in the reports of the > induced fit simulation.

 * <b> 3. entropy:</b> Directory with the code related to the Ligand Conformational Entropy (LiCE) calculation

   * **3.1 lice.py**: Script that reads the results from dihedral clustering and further processes information to obtain an entropy change.
 
   * **3.2. dihedral_clustering.py**: Script that calculates dihedral angles for all the rotatable bonds in all the conformations reached 
 by the ligand in a simulation. This information will be used to cluster conformations. 

   * **3.3. entropy.py**: Script that ensembles the other two to make a complete entropy analysis of a simulation.

 * <b> 4. initial_files:</b> Directory with an example of the necessary files to perform a full simulation of the protocol.

 * <b> 5. strain:</b> Directory with the code related to the calculation of the Ligand Internal Energy (LInEn).
 
   * **5.1. linen.py**: Script to calculate LInEN with a PELE simulation of the ligand. 

 * <b> 6. structural:</b> Directory with the code related to the rmsd calculation of the protein-ligand induced fit simulation. 

   * **6.1. rmsd.py**: Script that prepares all to run an rmsd calculation in MN4.


## Examples

In all cases the usage of the flag _-h_ is recommended in order to understand the possibilities offered by the script.
In case of doubt all functions are commented. For example

```
python path/to/code/bootstrapping.py -h
```

### analysis 

All the analysis scripts are designed to be run from the father directory of the _output_ directory generated by PELE.

1. _disc.py_: In this case we want to analyze the reports inside output_1 and we want to take a look at the fifth metric.

```
python path/to/code/disc.py -d ouput_1 -c 5
```
